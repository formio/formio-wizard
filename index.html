<!doctype html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <title>Formio Wizard Example</title>
    <meta name="description" content="A raw form to use with https://form.io">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="bower_components/ui-select/dist/select.css" />
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="bower_components/formio/css/formio.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body ng-app="formioWizard" ng-controller="WizardController">

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://form.io"><img style="height: 2em; margin-top: -0.5em;" src='https://portal.form.io/images/formio-logo-white.png' /></a>
        </div>
      </div>
    </nav>
    <div class="jumbotron" style="margin-top: 50px;">
      <div class="container">
        <p>This is an example of how to implement a wizard using Form.io.</p>
        <a class="btn btn-primary" href="https://github.com/formio/formio-wizard">Learn more</a>
      </div>
    </div>
    <div class="container">
      <div class="row bs-wizard" style="border-bottom:0;">
        <div ng-class="{disabled: ($index > currentPage), active: ($index == currentPage), complete: ($index < currentPage)}" class="{{ colclass }} bs-wizard-step" ng-repeat="page in pages">
          <div class="text-center bs-wizard-stepnum">{{ page }}</div>
          <div class="progress"><div class="progress-bar"></div></div>
          <a ng-click="gotoPage($index)" class="bs-wizard-dot"></a>
        </div>
      </div>
      <style type="text/css">.bs-wizard > .bs-wizard-step:first-child { margin-left: {{ margin }}%; }</style>
    </div>
    </div>
    <div class="container">
      <!-- The Form.io Wizard Element. -->
      <formio-wizard ng-show="!wizardDone" storage="'wizard'" src="'https://wizard.form.io/wizard'"></formio-wizard>

      <!-- Show submission info the wizard is done. -->
      <submission-info ng-show="wizardDone" submission="submission"></submission-info>
    </div>

    <script src="bower_components/jquery/dist/jquery.js"></script>
    <script src="bower_components/angular/angular.js"></script>
    <script src="bower_components/ng-file-upload/ng-file-upload.js"></script>
    <script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
    <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    <script src="bower_components/moment/moment.js"></script>
    <script src="bower_components/angular-moment/angular-moment.js"></script>
    <script src="bower_components/ui-select/dist/select.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="bower_components/bootstrap-ui-datetime-picker/dist/datetime-picker.min.js"></script>
    <script src="bower_components/signature_pad/signature_pad.js"></script>
    <script src="bower_components/angular-ui-mask/dist/mask.js"></script>
    <script src="bower_components/formio/dist/formio.js"></script>
    <script src="src/wizard.js"></script>
    <script type="text/javascript">
      angular.module('formioWizard', ['formio.wizard'])
        .directive('submissionInfo', function() {
          return {
            restrict: 'E',
            replace: true,
            template:
              '<div class="panel panel-default">' +
                '<div class=ui.mask"panel-heading">Submitted Data</div>' +
                '<ul class="list-group">' +
                  '<li class="list-group-item" ng-repeat="(key, value) in submission.data"><strong>{{ key }}</strong> - {{ value }}</li>' +
                '</ul>' +
              '</div>',
            scope: {
              submission: '='
            }
          };
        })
        .controller('WizardController', [
          '$scope',
          function(
            $scope
          ) {
            $scope.pages = [];
            $scope.wizardDone = false;
            $scope.submission = {};
            $scope.currentPage = 0;
            $scope.colclass = '';
            $scope.$on('formSubmission', function(event, submission) {
              $scope.wizardDone = true;
              $scope.submission = submission;
            });
            $scope.gotoPage = function(index) {
              $scope.$broadcast('wizardGoToPage', index);
            };
            $scope.$on('wizardPage', function(event, page) {
              $scope.currentPage = page;
            });
            $scope.$on('wizardFormLoad', function(event, form) {
              angular.forEach(form.components, function(component) {
                $scope.pages.push(component.title);
              });

              if ($scope.pages.length > 6) {
                $scope.margin = ((1 - ($scope.pages.length * 0.0833333333)) / 2) * 100;
                $scope.colclass = 'col-sm-1';
              }
              else {
                $scope.margin = ((1 - ($scope.pages.length * 0.1666666667)) / 2) * 100;
                $scope.colclass = 'col-sm-2';
              }
            });
          }
        ]);
    </script>
</body>
</html>
